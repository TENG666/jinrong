# **第五章.引用类型**

---
## 5.1 Object类型

ECMAScript 提供了很多原生引用类型（例如Object），以便开发人员用以实现常见的计算任务。
在通过对象字面量定义对象时，实际上不会调用Object构造函数（Firefox2及更早版本会调用 Object 构造函数；但 Firefox 3 之后就不会了）。


方括号语法的主要优点是可以通过变量来访问属性，例如：

    var propertyName = "name";
    alert(person[propertyName]); //"Nicholas" 
如果属性名中包含会导致语法错误的字符，或者属性名使用的是关键字或保留字，也可以使用方括号表示法。例如：

    person["first name"] = "Nicholas"; 
由于"first name"中包含一个空格，所以不能使用点表示法来访问它。然而，属性名中是可以包含非字母非数字的，这时候就可以使用方括号表示法来访问它们。
通常，除非必须使用变量来访问属性，否则我们建议使用点表示法。

## 5.2 Array类型

如果预先知道数组要保存的项目数量，也可以给构造函数传递该数量，而该数量会自动变成 length属性的值。例如，下面的代码将创建 length 值为 20 的数组。

    var colors = new Array(20);
也可以向 Array 构造函数传递数组中应该包含的项。以下代码创建了一个包含 3 个字符串值的数组：

    var colors = new Array("red", "blue", "green"); 
另外，在使用 Array 构造函数时也可以省略 new 操作符。如下面的例子所示，省略 new 操作符的结果相同：

    var colors = Array(3); // 创建一个包含 3 项的数组
    var names = Array("Greg"); // 创建一个包含 1 项，即字符串"Greg"的数组

在 IE 中，values 会成为一个包含 3 个项且每项的值分别为 1、2 和 undefined 的数组；在其他浏览器中，values 会成为一个包含2项且值分别为1和2的数组。原因是 IE8 及之前版本中的 ECMAScript 实现在数组字面量方面存在 bug。

    var values = [1,2,]; // 不要这样！这样会创建一个包含 2 或 3 项的数组
    
    
与对象一样，在使用数组字面量表示法时，也不会调用 Array 构造函数（Firefox 3
及更早版本除外）。

数组的 length 属性很有特点——它不是只读的。因此，通过设置这个属性，可以从数组的末尾移除项或向数组中添加新项。请看下面的例子：

    var colors = ["red", "blue", "green"]; // 创建一个包含 3 个字符串的数组
    colors.length = 2;
    alert(colors[2]); //undefined 
    
自从 ECMAScript 3 做出规定以后，就出现了确定某个对象是不是数组的经典问题。对于一个网页，或者一个全局作用域而言，使用instanceof操作符就能得到满意的结果：

    if (value instanceof Array){
    //对数组执行某些操作
    }
instanceof 操作符的问题在于，它假定只有一个全局执行环境。如果网页中包含多个框架，那实际上就存在两个以上不同的全局执行环境，从而存在两个以上不同版本的 Array 构造函数。如果你从一个框架向另一个框架传入一个数组，那么传入的数组与在第二个框架中原生创建的数组分别具有各自不同的构造函数。
为了解决这个问题，ECMAScript5新增了Array.isArray()方法。这个方法的目的是最终确定某个值到底是不是数组，而不管它是在哪个全局执行环境中创建的。这个方法的用法如下。
    
    if (Array.isArray(value)){
    //对数组执行某些操作
    }
支持 Array.isArray()方法的浏览器有 IE9+、Firefox 4+、Safari 5+、Opera 10.5+和 Chrome。要在尚未实现这个方法中的浏览器中准确检测数组，请参考 22.1.1 节。

如前所述，所有对象都具有toLocaleString()、toString()和valueOf()方法。其中，调用数组的 toString()方法会返回由数组中每个值的字符串形式拼接而成的一个以逗号分隔的字符串。而调用valueOf()返回的还是数组。是数组。用console.log就能显示Array(3),实际上，为了创建这个字符串会调用数组每一项的 toString()方法。来看下面这个例子。

    var colors = ["red", "blue", "green"]; // 创建一个包含 3 个字符串的数组
    alert(colors.toString()); // red,blue,green
    alert(colors.valueOf()); // red,blue,green，但是这是个数组
    alert(colors); // red,blue,green 


toString()和valueOf()方法的异同点：
共同点:在 JavaScript 中，toString()方法和valueOf()方法，在输出对象时会自动调用。
不同点：
(1)、二者并存的情况下，在数值运算中，优先调用了valueOf，字符串运算中，优先调用了toString。

代码如下:
    
    var obj = {};
    obj.valueOf = function()
    {
        return 10;
    }
    obj.toString = function()
    {
        return "return value";
    }

    var result = obj + 1; //var result = obj.valueOf() + 1;
    alert(result);
    alert(obj); //alert(obj.toString());
 

(2)返回值类型的差别：

toString一定将所有内容转为字符串

valueOf取出对象内部的值，不进行类型转换

(3)用途的差别：

valueOf专用于算数计算和关系运算

toString专用于输出字符串